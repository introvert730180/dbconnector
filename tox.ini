[testenv]
deps = -rrequirements_dev.txt
commands =
    # stop the build if there are Python syntax errors or undefined names
    flake8 src --count --select=E9,F63,F7,F82 --show-source --statistics
    # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide
    flake8 src --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
    # type linting
    mypy src/
    # pytest unit
    pytest --src src/unit -v tests/unit
    # pytest integration
    pytest --src src/integration -v tests/integration

[testenv:coverage]
deps =
    coverage[toml]
configure_command = coverage run --source={env_name} --omit={env_name}/venv/lib/site-packages/coverage -m pytest
commands =
    coverage xml --include={env_name}/_coverage --omit={env_name}/_coverage/__init__.py --append
    coverage report -m
